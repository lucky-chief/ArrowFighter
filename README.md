# ArrowFighter
Arrow.io是一款射击类游戏，io系列新作。比球球和贪吃蛇的玩法又复杂了一个模式，加入了等级系统。每次升级可以获得技能三选一。金币可以购买进阶的人物。<br>
玩了一下很快就上瘾了，进而有想自己用Unity实现一下这款游戏的想法。当然只是机制，玩法上的尽量还原，美术上就用简单的cube加一些简单的动画来用了，毕竟我只是个码农。不管还原度多少，先做吧。。下面我会把实现这款游戏的步骤和想法成文，记录下来。<br>
## 地图
* `地图的生成`<br>
这个我认为arrow.io里面的地图不是随机生成的，而是预先做好了预制(可能有几套)，然后加载进来就行。就像dota，lol的地图一样定死的。毕竟moba类地图的多样化不是很重要，反而是更加追求无变化地形，以方便玩家能方便地记住地形。
* `经验食物和血量食物的生成`<br>
先看看arrow.io里食物的分布：<br>
![](https://github.com/lucky-chief/imageCache/raw/master/food.jpg)  <br>
可以知道：<br>
	* 食物是随机分布的 <br>
	* 食物不会生成在墙体里面 <br>
	* 食物之间不会重叠 <br>

看到第一第二点，可以知道地图的空闲区域（即是玩家可以行走区域的合集）在代码逻辑里应该是知道的。知道了空闲区域，就可以很容易地满足以上三点要求来随机生成食物。于是一个很老套的技术浮现出来就是`刷格子`。人为地把地图的空闲区域用一个一个的方形格子标记出来。说道`刷格子`，以前做页游的时候，真是累死人，淡淡（蛋蛋）的忧伤啊。好在这款游戏地形类型比较简单，就两种：能走和不能走。还是用Unity。所以刷格子也不会那么费时费力了。怎么不费时费力，且看下文：<br>
`主要步骤：`<br>
用四根射线组成一定size的方格从地图正上方同时向正下方打去，此时地图的地板和墙体的layer都已经分别设置成了`Ground`和`Wall`。规定如果有两根（包含）以上的射线打到了墙上则表示这个方块的区域不是空闲区域，标记为0；反则是空闲区域，标记为1。如此反复地从地图的左上角一直扫描至地图的右下角即可完成`刷格子`工作。标记好的格子存入到一个文件里，以便读取。如下图：<br>
四根射线：<br>
![](https://github.com/lucky-chief/imageCache/raw/master/ray.png)  <br>
刷格子之前的地图：<br>
![](https://github.com/lucky-chief/imageCache/raw/master/map1.png)  <br>
刷格子之后的地图：<br>
![](https://github.com/lucky-chief/imageCache/raw/master/map2.png)  <br>
![](https://github.com/lucky-chief/imageCache/raw/master/map3.png)  <br>
为了方便观察，我把空闲区域的格子都用一个球体占住了。可以看见地图里面的墙体都是空的（0），说明这招行得通。<br>
把数据存入文件里即可。<br>
![](https://github.com/lucky-chief/imageCache/raw/master/mapdata.png)  <br>
其中前三个数据分别是地图的列数、行数、格子的size。数据之间用“|”隔开了。<br>
好的，有了这些数据，就可以生成食物了。大体步骤：
>* 读取文件
>* 把地图的空闲区域提取至一个数组
>* 从这个数组中随机出一个元素，并根据地图数据的前三个数据得到这个元素的位置信息
>* 把上一步随出来的元素从数组中移除
>* 生成食物并把上一步的位置信息付给它<br>

如下图：<br>
![](https://github.com/lucky-chief/imageCache/raw/master/mapfood.png)  <br>
其中绿色的是经验，红色的血，生成数量分别是300和100，数量是可以控制的。多了性能可能会急剧下降。<br>
可以明显地看到食物的生成完全符合了以上三点。所以这是可以行的。<br>
接下来我打算写一下人物的控制，这款只有两种控制，一个是控制行走，另外一个就是射击了。<br>
先把标题打上吧。<br>
## 人物控制
